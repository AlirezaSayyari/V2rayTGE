#!/usr/bin/env bash
set -euo pipefail

APP_DIR="/opt/egress-v2raya"
SCRIPTS="$APP_DIR/scripts"

if [[ ! -d "$SCRIPTS" ]]; then
  echo "ERROR: $SCRIPTS not found. Did you run deploy.sh?"
  exit 1
fi

menu() {
  clear
  cat <<'EOF'
=========================================
 EGRESS + v2rayA (GRE + PBR) CLI Dashboard
=========================================
  1) Help & Introduction
  2) Config Egress System
  3) Activate / Deactivate Egress System
  4) Health Check
  5) Log
  0) Exit
EOF
  echo
  read -rp "Select: " choice
  echo
  case "${choice:-}" in
    1) "$SCRIPTS/common.sh" help ;;
    2) "$SCRIPTS/config-wizard.sh" ;;
    3) "$SCRIPTS/common.sh" actmenu ;;
    4) "$SCRIPTS/healthcheck.sh" ;;
    5) "$SCRIPTS/common.sh" logmenu ;;
    0) exit 0 ;;
    *) echo "Invalid choice"; sleep 1 ;;
  esac
}

while true; do
  menu
done